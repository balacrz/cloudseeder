{
  "identify": { "matchKey": "External_Id__c" },

  "shape": {
    "fieldMap": {},
    "defaults": {
      "StageName": "${constants.oppty.defaultStageName}",
      "CloseDate": "${constants.oppty.defaultCloseDate}"
    },
    "removeFields": []
  },

  "transform": {
    "pre": [],
    "post": [
        { "op": "remove", "field": "AccountExternalId" }
    ]
  },

  "references": [
    {
      "field": "AccountId",
      "refObject": "Account",
      "refKey": "${AccountExternalId}",
      "required": true
    }
  ],

  "validate": {
    "requiredFields": ["External_Id__c", "Name", "StageName", "CloseDate", "AccountId"],
    "uniqueBy": ["External_Id__c"]
  },

  "strategy": {
    "operation": "upsert",
    "externalIdField": "External_Id__c",
    "api": "bulk",
    "batchSize": 200
  }
}
